{{ define "main" }}
<div
  class="chat-container"
  hx-ext="ws"
  ws-connect="/ws"
  hx-target="#messagesContainer"
  hx-swap="beforeend"
>
  <div class="chat-header">
    <hgroup>
      <h2>General Chat</h2>
      <p>Monitoring Session</p>
    </hgroup>
    <span class="user-count" id="userCount">3 users online</span>
  </div>

  <div class="messages-container" id="messagesContainer"></div>

  <div class="input-container">
    <form
      class="input-form"
      ws-send
      hx-target="#messagesContainer"
      hx-swap="beforeend"
      hx-on::ws-after-send="this.querySelector('#messageInput').value=''; this.querySelector('#messageInput').focus()"
    >
      <input
        type="text"
        class="message-input"
        id="messageInput"
        name="message"
        placeholder="Type a message..."
        autocomplete="off"
        required
        autofocus
      />
      <input type="hidden" name="name" value="{{ .Name }}" />
      <input type="hidden" name="gender" value="{{ .Gender }}" />
      <button type="submit" class="send-button">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22,2 15,22 11,13 2,9"></polygon>
        </svg>
      </button>
    </form>
    <form ws-send hx-trigger="load">
      <input type="hidden" name="name" value="{{ .Name }}" />
      <input type="hidden" name="gender" value="{{ .Gender }}" />
    </form>
  </div>
</div>
{{ end }}
